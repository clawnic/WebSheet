(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4955:(e,t,s)=>{Promise.resolve().then(s.bind(s,9233))},9233:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>B});var r=s(5155),l=s(2115),a=s(4624),n=s(2085),i=s(2596),o=s(9688);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:s,size:l,asChild:n=!1,...d}=e,u=n?a.DX:"button";return(0,r.jsx)(u,{"data-slot":"button",className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,i.$)(t))}(c({variant:s,size:l,className:t})),...d})}var u=s(7434),h=s(8564),x=s(4186),m=s(7580),v=s(5623);function g(){let[e,t]=(0,l.useState)("home"),[s,a]=(0,l.useState)("Untitled spreadsheet"),[n,i]=(0,l.useState)(!1),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{n&&o.current&&(o.current.focus(),o.current.select())},[n]),(0,r.jsxs)("div",{className:"border-b bg-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"w-6 h-6 text-green-600"}),n?(0,r.jsx)("input",{ref:o,type:"text",value:s,onChange:e=>a(e.target.value),onBlur:()=>i(!1),onKeyDown:e=>{("Enter"===e.key||"Escape"===e.key)&&i(!1)},className:"font-semibold border rounded px-1 py-0.5 text-sm w-48"}):(0,r.jsx)("span",{className:"font-semibold cursor-pointer hover:bg-gray-100 px-1 rounded",onClick:()=>i(!0),title:"Rename spreadsheet",children:s}),(0,r.jsx)(h.A,{className:"w-4 h-4 text-gray-400 hover:text-yellow-500 cursor-pointer"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(d,{variant:"ghost",size:"sm",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-1"}),"Last edit was 2 minutes ago"]}),(0,r.jsxs)(d,{variant:"outline",size:"sm",children:[(0,r.jsx)(m.A,{className:"w-4 h-4 mr-1"}),"Share"]}),(0,r.jsx)(d,{variant:"ghost",size:"sm",children:(0,r.jsx)(v.A,{className:"w-4 h-4"})})]})]}),(0,r.jsx)("div",{className:"flex items-center px-4",children:[{id:"home",label:"Home"},{id:"insert",label:"Insert"},{id:"page-layout",label:"Page Layout"},{id:"formulas",label:"Formulas"},{id:"data",label:"Data"},{id:"review",label:"Review"},{id:"view",label:"View"}].map(s=>(0,r.jsx)("button",{onClick:()=>{t(s.id),console.log("Switched to ".concat(s.label," tab"))},className:"px-4 py-2 text-sm font-medium border-b-2 transition-colors ".concat(e===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:s.label},s.id))})]})}let f=e=>{let t="";for(;e>=0;)t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26)-1;return t},b=(e,t)=>"".concat(f(t)).concat(e+1),p=e=>{let t=e.match(/^([A-Z]+)(\d+)$/);if(!t)throw Error("Invalid cell ID");let s=t[1],r=t[2],l=0;for(let e=0;e<s.length;e++)l=26*l+(s.charCodeAt(e)-64);return l-=1,{row:Number.parseInt(r)-1,col:l}},j=e=>e.startsWith("=")&&!e.includes("#"),y=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(s.has(e))return"#CIRCULAR";let r=t[e];if(!r)return"0";if(r.formula&&j(r.formula)){s.add(e);let l=w(r.formula,t,s);return s.delete(e),l}return r.value||"0"},w=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!e.startsWith("="))return e;try{let r=e.slice(1).replace(/[A-Z]+\d+/g,e=>y(e,t,s));return Function("return ".concat(r))().toString()}catch(e){return"#ERROR"}};function N(e){let{cells:t,selectedCell:s,onCellSelect:a,onCellChange:n}=e,[i,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(""),u=(0,l.useRef)(null),h=(0,l.useRef)(null),[x,m]=(0,l.useState)(Array(26).fill(96)),v=(0,l.useRef)(null),g=(0,l.useRef)(0),y=(0,l.useRef)(0),N=e=>{a(e),o(e);let s=t[e];d((null==s?void 0:s.formula)||(null==s?void 0:s.value)||""),console.log("Selected and editing cell: ".concat(e))},k=()=>{},A=e=>{d(e.target.value)},C=e=>{"Enter"===e.key?i&&(n(i,c),o(null),d("")):"Escape"===e.key&&(o(null),d(""))},z=()=>{i&&(n(i,c),o(null),d(""))};(0,l.useEffect)(()=>{i&&u.current&&u.current.focus()},[i]),(0,l.useEffect)(()=>{let e=e=>{if(!s||i)return;let{row:t,col:r}=p(s),l=t,n=r;if("ArrowUp"===e.key)l=Math.max(0,t-1);else if("ArrowDown"===e.key)l=Math.min(99,t+1);else if("ArrowLeft"===e.key)n=Math.max(0,r-1);else{if("ArrowRight"!==e.key)return;n=Math.min(25,r+1)}a(b(l,n)),e.preventDefault()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,i,a]);let S=e=>{let s=t[e];return s?s.formula&&j(s.formula)?w(s.formula,t):s.value:""},E=e=>({fontFamily:(null==e?void 0:e.fontFamily)||"Arial",fontSize:((null==e?void 0:e.fontSize)||12)+"px",fontWeight:(null==e?void 0:e.bold)?"bold":"normal",fontStyle:(null==e?void 0:e.italic)?"italic":"normal",textDecoration:(null==e?void 0:e.underline)?"underline":"none"}),R=(e,t)=>{e.preventDefault(),v.current=t,g.current=e.clientX,y.current=x[t],document.addEventListener("mousemove",D),document.addEventListener("mouseup",F)},D=e=>{if(null===v.current)return;let t=e.clientX-g.current;m(e=>{let s=[...e];return s[v.current]=Math.max(40,y.current+t),s})},F=()=>{v.current=null,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",F)};return(0,r.jsx)("div",{ref:h,className:"flex-1 overflow-auto bg-white",children:(0,r.jsx)("div",{className:"inline-block min-w-full",children:(0,r.jsxs)("table",{className:"border-collapse",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"w-12 h-8 border border-gray-300 bg-gray-100 text-xs font-medium text-gray-600 sticky top-0 left-0 z-20"}),Array.from({length:26},(e,t)=>(0,r.jsxs)("th",{style:{width:x[t]},className:"relative h-8 border border-gray-300 bg-gray-100 text-xs font-medium text-gray-600 sticky top-0 z-10 group",children:[f(t),(0,r.jsx)("div",{onMouseDown:e=>R(e,t),className:"absolute top-0 right-0 h-full w-2 cursor-col-resize group-hover:bg-blue-200",style:{zIndex:30}})]},t))]})}),(0,r.jsx)("tbody",{children:Array.from({length:100},(e,l)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"w-12 h-6 border border-gray-300 bg-gray-100 text-xs font-medium text-gray-600 text-center sticky left-0 z-10",children:l+1}),Array.from({length:26},(e,a)=>{let n=b(l,a),o=s===n,d=i===n,h=S(n),m=t[n];return(0,r.jsx)("td",{style:{width:x[a]},className:"w-24 h-6 border border-gray-300 relative cursor-cell ".concat(o?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"),onClick:()=>N(n),onDoubleClick:()=>k(),children:d?(0,r.jsx)("input",{ref:u,type:"text",value:c,onChange:A,onKeyDown:C,onBlur:z,className:"w-full h-full px-1 text-xs border-none outline-none bg-white",style:E(m)}):(0,r.jsx)("div",{className:"w-full h-full px-1 text-xs flex items-center overflow-hidden",style:E(m),children:h})},n)})]},l))})]})})})}var k=s(3654),A=s(8932),C=s(9727),z=s(9144),S=s(7240),E=s(7325),R=s(7733),D=s(8702),F=s(3127),L=s(6474),_=s(7210),I=s(4017),M=s(5868);function W(e){let{onAction:t,selectedCell:s,cell:l}=e;return(0,r.jsxs)("div",{className:"flex items-center gap-1 px-4 py-2 border-b bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("undo"),children:(0,r.jsx)(k.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("redo"),children:(0,r.jsx)(A.A,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,r.jsxs)("select",{className:"px-2 py-1 text-sm border rounded",value:(null==l?void 0:l.fontFamily)||"Arial",onChange:e=>t("fontFamily",e.target.value),disabled:!s,children:[(0,r.jsx)("option",{children:"Arial"}),(0,r.jsx)("option",{children:"Times New Roman"}),(0,r.jsx)("option",{children:"Helvetica"})]}),(0,r.jsxs)("select",{className:"px-2 py-1 text-sm border rounded ml-1",value:(null==l?void 0:l.fontSize)||12,onChange:e=>t("fontSize",Number(e.target.value)),disabled:!s,children:[(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:11,children:"11"}),(0,r.jsx)("option",{value:12,children:"12"}),(0,r.jsx)("option",{value:14,children:"14"}),(0,r.jsx)("option",{value:16,children:"16"})]})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,r.jsx)(d,{variant:(null==l?void 0:l.bold)?"default":"ghost",size:"sm",onClick:()=>t("bold"),children:(0,r.jsx)(C.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:(null==l?void 0:l.italic)?"default":"ghost",size:"sm",onClick:()=>t("italic"),children:(0,r.jsx)(z.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:(null==l?void 0:l.underline)?"default":"ghost",size:"sm",onClick:()=>t("underline"),children:(0,r.jsx)(S.A,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("align-left"),children:(0,r.jsx)(E.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("align-center"),children:(0,r.jsx)(R.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("align-right"),children:(0,r.jsx)(D.A,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mr-2",children:[(0,r.jsxs)(d,{variant:"ghost",size:"sm",onClick:()=>t("fill-color"),children:[(0,r.jsx)(F.A,{className:"w-4 h-4"}),(0,r.jsx)(L.A,{className:"w-3 h-3 ml-1"})]}),(0,r.jsxs)(d,{variant:"ghost",size:"sm",onClick:()=>t("borders"),children:[(0,r.jsx)(_.A,{className:"w-4 h-4"}),(0,r.jsx)(L.A,{className:"w-3 h-3 ml-1"})]})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("percent"),children:(0,r.jsx)(I.A,{className:"w-4 h-4"})}),(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>t("currency"),children:(0,r.jsx)(M.A,{className:"w-4 h-4"})})]})]})}var K=s(4416),O=s(5196);function P(e){let{selectedCell:t,cells:s,onCellChange:a,cellValue:n,onValueChange:i,onConfirm:o,onCancel:c}=e,[u,h]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if("string"==typeof n)h(n);else if(t&&s){let e=s[t];h((null==e?void 0:e.formula)||(null==e?void 0:e.value)||"")}},[t,s,n]),(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2 border-b",children:[(0,r.jsx)("div",{className:"w-24 px-2 py-1 bg-gray-100 border rounded text-sm",children:t||""}),(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:u,onChange:e=>{h(e.target.value),m(!0),i&&i(e.target.value)},onKeyDown:e=>{"Enter"===e.key?(o?o():a&&t&&a(t,u),m(!1)):"Escape"===e.key&&(c&&c(),m(!1))},className:"flex-1 px-2 py-1 border rounded text-sm",placeholder:"Enter a value or formula..."}),x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{variant:"outline",size:"icon",onClick:()=>{if(c)c();else if(t&&s){let e=s[t];h((null==e?void 0:e.formula)||(null==e?void 0:e.value)||"")}m(!1)},className:"h-8 w-8",children:(0,r.jsx)(K.A,{className:"h-4 w-4"})}),(0,r.jsx)(d,{size:"icon",onClick:()=>{o?o():a&&t&&a(t,u),m(!1)},className:"h-8 w-8",children:(0,r.jsx)(O.A,{className:"h-4 w-4"})})]})]})]})}var U=s(4616);function X(e){let{activeSheet:t,onSheetChange:s}=e,l=e=>{s(e),console.log("Switched to ".concat(e))};return(0,r.jsxs)("div",{className:"flex items-center gap-1 px-4 py-2 border-t bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[["Sheet1","Sheet2","Sheet3"].map(e=>(0,r.jsx)("button",{onClick:()=>l(e),className:"px-3 py-1 text-sm rounded-t border-t border-l border-r ".concat(t===e?"bg-white border-gray-300 text-gray-900":"bg-gray-100 border-gray-200 text-gray-600 hover:bg-gray-200"),children:e},e)),(0,r.jsx)(d,{variant:"ghost",size:"sm",onClick:()=>{console.log("Add new sheet")},className:"ml-2",children:(0,r.jsx)(U.A,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsx)(d,{variant:"ghost",size:"sm",children:(0,r.jsx)(v.A,{className:"w-4 h-4"})})]})}function B(){let[e,t]=(0,l.useState)({}),[s,a]=(0,l.useState)(null),[n,i]=(0,l.useState)("Sheet1"),o=(e,s)=>{t(t=>{var r;return{...t,[e]:{...t[e],id:e,value:s,formula:s.startsWith("=")?s:void 0,row:parseInt((null===(r=e.match(/\d+/))||void 0===r?void 0:r[0])||"0"),col:e.charCodeAt(0)-65}}})},c=e=>{s&&t(t=>({...t,[s]:{...t[s],...e}}))};return(0,r.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,r.jsx)(g,{}),(0,r.jsx)(W,{onAction:(t,r)=>{var l,a,n;"bold"===t?c({bold:!(null===(l=e[s])||void 0===l?void 0:l.bold)}):"italic"===t?c({italic:!(null===(a=e[s])||void 0===a?void 0:a.italic)}):"underline"===t?c({underline:!(null===(n=e[s])||void 0===n?void 0:n.underline)}):"fontFamily"===t?c({fontFamily:r}):"fontSize"===t&&c({fontSize:r})},selectedCell:s,cell:s?e[s]:void 0}),(0,r.jsx)(P,{selectedCell:s,cells:e,onCellChange:o}),(0,r.jsx)("div",{className:"flex-1 overflow-auto",children:(0,r.jsx)(N,{cells:e,selectedCell:s,onCellSelect:a,onCellChange:o})}),(0,r.jsx)(X,{activeSheet:n,onSheetChange:i})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[519,441,684,358],()=>t(4955)),_N_E=e.O()}]);